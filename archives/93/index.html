<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>内网信息收集 | A10ng_&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="判断当前机器是否在域内 1.查看当前⽹卡和IP信息： ipconfig /all 如果是域，在主dns处是域名 2、查看系统详细信息 Systeminfo 域内机器能看到域的地方是一个域名，同">
<meta name="author" content="admin">
<link rel="canonical" href="https://a10nggg.github.io/archives/93/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://a10nggg.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://a10nggg.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://a10nggg.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://a10nggg.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://a10nggg.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://a10nggg.github.io/archives/93/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="内网信息收集" />
<meta property="og:description" content="判断当前机器是否在域内 1.查看当前⽹卡和IP信息： ipconfig /all 如果是域，在主dns处是域名 2、查看系统详细信息 Systeminfo 域内机器能看到域的地方是一个域名，同" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://a10nggg.github.io/archives/93/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-11T06:29:12+00:00" />
<meta property="article:modified_time" content="2022-01-11T06:29:12+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="内网信息收集"/>
<meta name="twitter:description" content="判断当前机器是否在域内 1.查看当前⽹卡和IP信息： ipconfig /all 如果是域，在主dns处是域名 2、查看系统详细信息 Systeminfo 域内机器能看到域的地方是一个域名，同"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://a10nggg.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "内网信息收集",
      "item": "https://a10nggg.github.io/archives/93/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "内网信息收集",
  "name": "内网信息收集",
  "description": "判断当前机器是否在域内 1.查看当前⽹卡和IP信息： ipconfig /all 如果是域，在主dns处是域名 2、查看系统详细信息 Systeminfo 域内机器能看到域的地方是一个域名，同",
  "keywords": [
    
  ],
  "articleBody": "判断当前机器是否在域内 1.查看当前⽹卡和IP信息：\nipconfig /all\n如果是域，在主dns处是域名\n2、查看系统详细信息\nSysteminfo\n域内机器能看到域的地方是一个域名，同时能看机器上打的补丁，非域机器也要用这个命令\n3、查看当前登录域及域⽤户\nnet config workstation\n{.wp-editor-md-post-content-link}\n4、查看域内时间\nnet time /domain\n通过执⾏以上命令后有三种情况：\n存在域，当前⽤户不是域⽤户。此时会报拒绝访问。\n2.存在域、当前⽤户是域⽤户。这时会正常返回域内时间。\n3.不存在域。提示找不到域控制器。 本机信息搜集 1.获取本机⽹络配置信息\nipconfig /all\n2.查询操作系统和版本信息\n英⽂版系统⽤这条命令： systeminfo | findstr /B /C:\"OS Nmae\" /C:\"OS Version\"\n中⽂版系统⽤这条命令：systeminfo | findstr /B /C:\"OS 名称\" /C:\"OS 版本\"\n{.wp-editor-md-post-content-link}\n获取到版本和补丁信息以后，如果当前权限不是system，就可以找相应的exp提权。\n3.查看系统体系结构\necho %PROCESSOR_ARCHITECTURE% {.wp-editor-md-post-content-link}\n{.wp-editor-md-post-content-link}\n4.查看安装的软件及版本、路径\nwmic product get name,version\n{.wp-editor-md-post-content-link}\n查询进程列表 1、查看当前进程列表和软件进程\ntasklist\n2.查看当前进程列表对应的⽤户身份\ntasklist /v\n3、查看当前进程是否有杀毒软件（AV）\ntasklist /svc\n通过执⾏完这条命令后，我们就可以知道当前有哪些软件，以及对应的 PID 号、服务名，我们还可以吧执⾏命令的 返回结果去查询是否有杀毒软件：\ntasklist /svc\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n查看计划任务 通过查看本机计划任务我们就能知道当前机器上“某个时间”会运⾏哪些软件，我们就可以利⽤这⼀点来做定时任务 劫持。\nwmic startup get command,caption schtasks /query /fo LIST /v\n查询补丁信息 Systeminfo\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n{.wp-editor-md-post-content-link}\n查询路由表及所有可⽤接⼝的ARP缓冲表 Route print\n在内网渗透中都需要用到这个\narp -a\n看防⽕墙配置\nnetsh firewall show config\n若是想修改防⽕墙配置信息就可以使⽤：\n若是想要关闭防⽕墙就可以使⽤：\nwin 2003及之前的版本，运⾏指定程序全部连接：\nnetsh firewall add allowedprogram c:\\nc.exe \"allow nc\" enable\nwin 2003之后的版本⽤这条：\nnetsh advfirewall firewall add rule name=\"pass nc\" dir=in action=allow program=\"C:\\nc.exe\"\n允许指定程序连出，命令如下\nnetsh advfirewall firewall add rule name=\"Allow nc\" dir=out action=allow program=\"C:\\nc.exe\"\n允许 3389 端⼝放⾏，命令如下\nnetsh advfirewall firewall add rule name=\"Remote Desktop\" protocol=TCP dir=inlocalport=3389 action=allow\n⾃定义防⽕墙⽇志储存位置\nnetsh advfirewall set currentprofile logging filename \"C:\\windows\\temp\\fw.log\"\nwin 2003及之前的版本⽤这条命令： netsh firewall set opmode disable win 2003之后的版本⽤这条命令：\nnetsh advfirewall set allprofiles state off\n查询并开启远程桌⾯连接服务 REG QUERY \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /V PortNumber\n在 Windows Server 2003 中开启 3389 端⼝ wmic path win32_terminalservicesetting where (__CLASS !=\"\") call setallowtsconnections 1\n在 Windows Server 2008 和 Windows Server 2012 中开启 3389 端⼝ wmic /namespace:\\\\root\\cimv2\\terminalservices path win32_terminalservicesetting where (__CLASS !=\"\") call setallowtsconnections 1\nwmic /namespace:\\\\root\\cimv2\\terminalservices path win32_tsgeneralsetting where (TerminalName='RDP-Tcp') call setuserauthenticationrequired 1\n在 Windows 7 中开启 3389 端⼝ reg add \"HKLM\\SYSTEM\\CURRENT\\CONTROLSET\\CONTROL\\TERMINAL SERVER\" /v fSingleSessionPerUser /t REG_DWORD /d 0 /f\n域内信息搜集 搜集完本机的⼀些配置信息、IP信息、⽹卡信息、补丁信息后，我们接下来就要搜集域内的信息了，⽐如：域⽤ 户、域管理员、域控制器等信息。\n查询域内⽤户\nwhoami /all\n查看域⽤户的详细信息\n假如我们要查询 mssql这个域⽤户的信息，我们就可以使⽤：\nnet user mssql /domain\n{.wp-editor-md-post-content-link}\n查询域列表（如果有多个域）\nnet view /domain\n查询域管理员列表\nnet group “domain admins” /domain\n{.wp-editor-md-post-content-link}\n查看域内时间（时间服务器）\nnet time /domain\n查看登陆本机的域管理员 这条命令会显示本地管理员和域管理员。 查看域内所有⽤户组列表 net localgroup administrators /domain\n{.wp-editor-md-post-content-link}\n查看域内所有⽤户组列表\nnet group /domain\n{.wp-editor-md-post-content-link}\n查看主域控制器\nnetdom query pdc\n{.wp-editor-md-post-content-link}\n查看所有域控制器列表 ⼀个域可以有多个域控制器，通过查看域控制器列表我们就可以得到域控制器对应的机器名是多少，如果想要知道 它的 IP 是多少，我们只需要 Ping 它的机器名即可得到域控制器的 IP 地址：\nnet group \"Domain Controllers\" /domain\nPing -n 1 DC\n{.wp-editor-md-post-content-link}\n查询域信任信息\n通过查询域信任信息我们就可以知道当前有多少个域，域名是多少。\nnltest /domain_trusts\n{.wp-editor-md-post-content-link}\n查询域密码信息\n通过查询域密码信息我们就可以知道当前域⽤户多久修改⼀次密码，密码策略是多少（我们就可以根据密码策略来 制定⼀份密码字典，盲⽬的⽤字典会很浪费时间）。 net accounts /domain\n{.wp-editor-md-post-content-link}\n低权限下搜集当前机器各类密码文件 在渗透中拿到一台边缘机器，首先要将得到的机器翻个底朝天，不要直接去扫内网，通常会遇到一些比较新的机器，或者是已经把提权漏洞给修了，这时候也不要纠结去提权了，利用收集到的信息去进行更好的横向。\n搜集当前机器各类敏感密码配置⽂件\ndir /b /s user.*,pass.*,config.*,username.*,password.*\n{.wp-editor-md-post-content-link}\nfor 循环搜集当前机器各类敏感密码配置⽂件\nfor /r c:\\ %i in (pass.*) do @echo %i\nfindstr 命令查找某个⽂件的某个字段\n上⾯两条命令只是查找某个⽂件，那我们想要查找⼀个⽂件⾥有没有 user 、 pass 等字段内容，就可以使⽤这条 命令。\nfindstr /c:\"user\" /c:\"pass\" /si *.txt\n",
  "wordCount" : "1611",
  "inLanguage": "en",
  "datePublished": "2022-01-11T06:29:12Z",
  "dateModified": "2022-01-11T06:29:12Z",
  "author":{
    "@type": "Person",
    "name": "admin"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://a10nggg.github.io/archives/93/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "A10ng_'s Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://a10nggg.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://a10nggg.github.io/" accesskey="h" title="A10ng_&#39;s Blog (Alt + H)">A10ng_&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://a10nggg.github.io/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="https://a10nggg.github.io/posts/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://a10nggg.github.io/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://a10nggg.github.io/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://a10nggg.github.io/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://a10nggg.github.io/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      内网信息收集
    </h1>
    <div class="post-meta"><span title='2022-01-11 06:29:12 +0000 +0000'>January 11, 2022</span>&nbsp;·&nbsp;admin

</div>
  </header> 
  <div class="post-content"><h1 id="判断当前机器是否在域内">判断当前机器是否在域内<a hidden class="anchor" aria-hidden="true" href="#判断当前机器是否在域内">#</a></h1>
<p>1.查看当前⽹卡和IP信息：<br>
<code>ipconfig /all</code><br>
如果是域，在主dns处是域名</p>
<p>2、查看系统详细信息<br>
<code>Systeminfo</code><br>
域内机器能看到域的地方是一个域名，同时能看机器上打的补丁，非域机器也要用这个命令</p>
<p>3、查看当前登录域及域⽤户<br>
<code>net config workstation</code><br>
<a href="/uploads/2022/01/wp_editor_md_b29878276e6585da44fc70f011793f01.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_b29878276e6585da44fc70f011793f01.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}<br>
4、查看域内时间<br>
<code>net time /domain</code><br>
通过执⾏以上命令后有三种情况：</p>
<ol>
<li>存在域，当前⽤户不是域⽤户。此时会报拒绝访问。<br>
2.存在域、当前⽤户是域⽤户。这时会正常返回域内时间。<br>
3.不存在域。提示找不到域控制器。</li>
</ol>
<h1 id="本机信息搜集">本机信息搜集<a hidden class="anchor" aria-hidden="true" href="#本机信息搜集">#</a></h1>
<p>1.获取本机⽹络配置信息<br>
<code>ipconfig /all</code></p>
<p>2.查询操作系统和版本信息<br>
英⽂版系统⽤这条命令： <code>systeminfo | findstr /B /C:&quot;OS Nmae&quot; /C:&quot;OS Version&quot;</code><br>
中⽂版系统⽤这条命令：<code>systeminfo | findstr /B /C:&quot;OS 名称&quot; /C:&quot;OS 版本&quot;</code><br>
<a href="/uploads/2022/01/wp_editor_md_a49af465572677a8879a63da209c7cdf.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_a49af465572677a8879a63da209c7cdf.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>获取到版本和补丁信息以后，如果当前权限不是system，就可以找相应的exp提权。</p>
<p>3.查看系统体系结构</p>
<pre><code class="line-numbers">echo %PROCESSOR_ARCHITECTURE%
</code></pre>
<p><a href="/uploads/2022/01/wp_editor_md_59599a65d3e1d0842f0220e5bd23aeb6.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_59599a65d3e1d0842f0220e5bd23aeb6.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}<br>
<a href="/uploads/2022/01/wp_editor_md_77b151484c0b771879d94d06124a9567.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_77b151484c0b771879d94d06124a9567.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>4.查看安装的软件及版本、路径<br>
<code>wmic product get name,version</code></p>
<p><a href="/uploads/2022/01/wp_editor_md_274b9f80ce16802d29a462de110afa42.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_274b9f80ce16802d29a462de110afa42.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<h2 id="查询进程列表">查询进程列表<a hidden class="anchor" aria-hidden="true" href="#查询进程列表">#</a></h2>
<p>1、查看当前进程列表和软件进程<br>
<code>tasklist</code><br>
2.查看当前进程列表对应的⽤户身份<br>
<code>tasklist /v</code></p>
<p>3、查看当前进程是否有杀毒软件（AV）<br>
<code>tasklist /svc</code><br>
通过执⾏完这条命令后，我们就可以知道当前有哪些软件，以及对应的 PID 号、服务名，我们还可以吧执⾏命令的 返回结果去查询是否有杀毒软件：<br>
<code>tasklist /svc</code><br>
<code>wmic qfe get Caption,Description,HotFixID,InstalledOn</code></p>
<p>查看计划任务 通过查看本机计划任务我们就能知道当前机器上“某个时间”会运⾏哪些软件，我们就可以利⽤这⼀点来做定时任务 劫持。<br>
wmic startup get command,caption schtasks /query /fo LIST /v</p>
<h2 id="查询补丁信息">查询补丁信息<a hidden class="anchor" aria-hidden="true" href="#查询补丁信息">#</a></h2>
<p>Systeminfo<br>
wmic qfe get Caption,Description,HotFixID,InstalledOn<br>
<a href="/uploads/2022/01/wp_editor_md_16f107631aaadc80a722666d795ea9ca.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_16f107631aaadc80a722666d795ea9ca.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<h2 id="查询路由表及所有可接的arp缓冲表">查询路由表及所有可⽤接⼝的ARP缓冲表<a hidden class="anchor" aria-hidden="true" href="#查询路由表及所有可接的arp缓冲表">#</a></h2>
<p><code>Route print</code><br>
在内网渗透中都需要用到这个<br>
<code>arp -a</code></p>
<p>看防⽕墙配置<br>
<code>netsh firewall show config</code></p>
<p>若是想修改防⽕墙配置信息就可以使⽤：<br>
若是想要关闭防⽕墙就可以使⽤：<br>
win 2003及之前的版本，运⾏指定程序全部连接：<br>
<code>netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable</code><br>
win 2003之后的版本⽤这条：<br>
<code>netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C:\nc.exe&quot;</code><br>
允许指定程序连出，命令如下<br>
<code>netsh advfirewall firewall add rule name=&quot;Allow nc&quot; dir=out action=allow program=&quot;C:\nc.exe&quot;</code><br>
允许 3389 端⼝放⾏，命令如下<br>
<code>netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=inlocalport=3389 action=allow</code><br>
⾃定义防⽕墙⽇志储存位置<br>
<code>netsh advfirewall set currentprofile logging filename &quot;C:\windows\temp\fw.log&quot;</code><br>
win 2003及之前的版本⽤这条命令： netsh firewall set opmode disable win 2003之后的版本⽤这条命令：<br>
<code>netsh advfirewall set allprofiles state off</code></p>
<h3 id="查询并开启远程桌连接服务">查询并开启远程桌⾯连接服务<a hidden class="anchor" aria-hidden="true" href="#查询并开启远程桌连接服务">#</a></h3>
<p><code>REG QUERY &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber</code></p>
<h3 id="在-windows-server-2003-中开启-3389-端">在 Windows Server 2003 中开启 3389 端⼝<a hidden class="anchor" aria-hidden="true" href="#在-windows-server-2003-中开启-3389-端">#</a></h3>
<p><code>wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1</code></p>
<h3 id="在-windows-server-2008-和-windows-server-2012-中开启-3389-端">在 Windows Server 2008 和 Windows Server 2012 中开启 3389 端⼝<a hidden class="anchor" aria-hidden="true" href="#在-windows-server-2008-和-windows-server-2012-中开启-3389-端">#</a></h3>
<p><code>wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1</code></p>
<p><code>wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName='RDP-Tcp') call setuserauthenticationrequired 1</code></p>
<h3 id="在-windows-7-中开启-3389-端">在 Windows 7 中开启 3389 端⼝<a hidden class="anchor" aria-hidden="true" href="#在-windows-7-中开启-3389-端">#</a></h3>
<p><code>reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f</code></p>
<h1 id="域内信息搜集">域内信息搜集<a hidden class="anchor" aria-hidden="true" href="#域内信息搜集">#</a></h1>
<p>搜集完本机的⼀些配置信息、IP信息、⽹卡信息、补丁信息后，我们接下来就要搜集域内的信息了，⽐如：域⽤ 户、域管理员、域控制器等信息。</p>
<p>查询域内⽤户<br>
<code>whoami /all</code></p>
<p>查看域⽤户的详细信息<br>
假如我们要查询 mssql这个域⽤户的信息，我们就可以使⽤：<br>
<code>net user mssql /domain</code></p>
<p><a href="/uploads/2022/01/wp_editor_md_5069e28f6f39cece7614919528160f41.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_5069e28f6f39cece7614919528160f41.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>查询域列表（如果有多个域）<br>
<code>net view /domain</code></p>
<p>查询域管理员列表<br>
net group &ldquo;domain admins&rdquo; /domain<br>
<a href="/uploads/2022/01/wp_editor_md_f32529feb20eacb198fdb2feba7bcc53.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_f32529feb20eacb198fdb2feba7bcc53.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>查看域内时间（时间服务器）<br>
<code>net time /domain</code></p>
<p>查看登陆本机的域管理员 这条命令会显示本地管理员和域管理员。 查看域内所有⽤户组列表 net localgroup administrators /domain<br>
<a href="/uploads/2022/01/wp_editor_md_8fd84551f30ff2310a788915cdea6bf6.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_8fd84551f30ff2310a788915cdea6bf6.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>查看域内所有⽤户组列表<br>
<code>net group /domain</code><br>
<a href="/uploads/2022/01/wp_editor_md_d21179b7134c732ca7f77b67c43fc19e.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_d21179b7134c732ca7f77b67c43fc19e.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>查看主域控制器<br>
<code>netdom query pdc</code></p>
<p><a href="/uploads/2022/01/wp_editor_md_3e768e49e6b552dd1583e7004eeb66da.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_3e768e49e6b552dd1583e7004eeb66da.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}<br>
查看所有域控制器列表 ⼀个域可以有多个域控制器，通过查看域控制器列表我们就可以得到域控制器对应的机器名是多少，如果想要知道 它的 IP 是多少，我们只需要 Ping 它的机器名即可得到域控制器的 IP 地址：<br>
<code>net group &quot;Domain Controllers&quot; /domain</code></p>
<p><code>Ping -n 1 DC</code><br>
<a href="/uploads/2022/01/wp_editor_md_962bd15765d8b7f1edd7abb3e7597697.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_962bd15765d8b7f1edd7abb3e7597697.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>查询域信任信息<br>
通过查询域信任信息我们就可以知道当前有多少个域，域名是多少。<br>
<code>nltest /domain_trusts</code></p>
<p><a href="/uploads/2022/01/wp_editor_md_92990534a9c90fcff42b2c5b8a7b8035.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_92990534a9c90fcff42b2c5b8a7b8035.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}<br>
查询域密码信息<br>
通过查询域密码信息我们就可以知道当前域⽤户多久修改⼀次密码，密码策略是多少（我们就可以根据密码策略来 制定⼀份密码字典，盲⽬的⽤字典会很浪费时间）。 <code>net accounts /domain</code><br>
<a href="/uploads/2022/01/wp_editor_md_7d09b40fae4be53b551a05631dc82a5d.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_7d09b40fae4be53b551a05631dc82a5d.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<h1 id="低权限下搜集当前机器各类密码文件">低权限下搜集当前机器各类密码文件<a hidden class="anchor" aria-hidden="true" href="#低权限下搜集当前机器各类密码文件">#</a></h1>
<p>在渗透中拿到一台边缘机器，首先要将得到的机器翻个底朝天，不要直接去扫内网，通常会遇到一些比较新的机器，或者是已经把提权漏洞给修了，这时候也不要纠结去提权了，利用收集到的信息去进行更好的横向。<br>
搜集当前机器各类敏感密码配置⽂件<br>
<code>dir /b /s user.*,pass.*,config.*,username.*,password.*</code><br>
<a href="/uploads/2022/01/wp_editor_md_9ea2913642f432cd83ebff69ed772fa6.jpg"><img loading="lazy" src="/uploads/2022/01/wp_editor_md_9ea2913642f432cd83ebff69ed772fa6.jpg" alt=""  />
</a>{.wp-editor-md-post-content-link}</p>
<p>for 循环搜集当前机器各类敏感密码配置⽂件<br>
<code>for /r c:\ %i in (pass.*) do @echo %i</code></p>
<p>findstr 命令查找某个⽂件的某个字段<br>
上⾯两条命令只是查找某个⽂件，那我们想要查找⼀个⽂件⾥有没有 user 、 pass 等字段内容，就可以使⽤这条 命令。</p>
<p><code>findstr /c:&quot;user&quot; /c:&quot;pass&quot; /si *.txt</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://a10nggg.github.io/">A10ng_&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
